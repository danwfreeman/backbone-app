/**
 *  Slider Kit imageFx, v.1.0 - 2012/01/10
 *  http://www.kyrielles.net/sliderkit
 *  
 *  Copyright (c) 2010-2012 Alan Frog
 *  Licensed under the GNU General Public License
 *  See <license.txt> or <http://www.gnu.org/licenses/>
 *  
 *  Requires : jQuery Slider Kit v1.9+
 * 
 *	-----------------------------------------
 *	Slider Kit imageFx add-on was built from jqFancyTransitions jQuery plugin by Ivan Lazarevic.
 *
 *	jqFancyTransitions - jQuery plugin
 *	Examples and documentation at: http://www.workshop.rs/projects/jqfancytransitions
 *	
 *	Dual licensed under the MIT and GPL licenses:
 *  http://www.opensource.org/licenses/mit-license.php
 *	http://www.gnu.org/licenses/gpl.html
 */

(function(e){SliderKit.prototype.imageFx=function(){var t=this,n={strip:t.options.cssprefix+"-strip",imageFxAnchor:t.options.cssprefix+"-imagefx-anchor",textbox:t.options.cssprefix+"-panel-textbox"},r={fxType:"curtain",fxDelay:60,strips:10,stripOrientation:"default",stripPosition:"default",stripDirection:"default",fxDuration:500},i=new Array("default","curtain","zipper","wave","fountain"),s=function(e,t){var n=e.length;if(n==0)return!1;while(n--){var r=Math.floor(Math.random()*(n+1)),i=e[n],s=e[r];e[n]=s,e[r]=i,t[n]=s,t[r]=i}},o=function(){t.panels.removeClass(t.cssNames.panelActive).hide(),t.currPanel.addClass(t.cssNames.panelActive).show().find("img").hide(),t.options.delaycaptions||e("."+n.textbox,t.currPanel).hide().fadeIn()},u=function(r,i,o,u){var a=new Array,f=new Array,l=1,c=0,h=null,p=0,d="",v="",m="",g="",y=0,b="",w=0,E=r.stripOrientation=="reverse"?t.domObjHeight:t.domObjWidth,S=parseInt(E/r.strips),x=null,T=e("."+n.strip,t.panelsBag),N=E%r.strips;switch(r.fxType){case"zipper":r.stripPosition="alternate",r.stripDirection=null;break;case"wave":break;case"curtain":r.stripPosition=null;break;case"fountain":r.stripDirection!="random"&&r.stripDirection!="default"&&(r.stripDirection="default")}r.stripOrientation=="reverse"?(d="top",v="left",m="right",g="height",b="width",w=t.domObjWidth,h={width:t.domObjWidth,opacity:1}):(r.stripOrientation="default",d="left",v="top",m="bottom",g="width",b="height",w=t.domObjHeight,h={height:t.domObjHeight,opacity:1});for(j=1;j<r.strips+1;j++){x=T.eq(j-1),N>0?(y=S+1,N--):y=S,x.css(d,p+"px").css(v,"0").css(g,y+"px").css(b,w+"px"),x.css("background-position",r.stripOrientation=="default"?-p+"px 0":"0 "+ -p+"px"),p+=y;if(r.stripPosition=="reverse"||j%2==0&&r.stripPosition=="alternate")x.css(m,"0"),x.css(v,"auto");r.fxType=="fountain"?(a[j-1]=parseInt(r.strips/2)-parseInt(j/2)*l,a[r.strips-1]=r.strips,l*=-1):a[j-1]=j,f[j-1]=y}r.stripDirection=="random"?s(a,f):r.stripDirection=="reverse"&&a[0]==1||r.stripPosition=="alternate"?(a.reverse(),f.reverse()):r.stripDirection=="auto"&&(u=="+="&&a[0]==1||u=="-="&&a[0]==r.strips)&&(a.reverse(),f.reverse()),t.panelsBag.css("background",'transparent url("'+o+'") no-repeat 0 0'),T.css(r.fxType=="curtain"?g:b,"0"),c=-1;var C=setInterval(function(){c++,r.fxType=="curtain"&&(h=r.stripOrientation=="default"?{width:f[c],opacity:1}:{height:f[c],opacity:1}),c==r.strips&&clearInterval(C),T.eq(a[c]-1).css({opacity:0,"z-index":3,"background-image":"url("+i+")"}).stop().animate(h,r.fxDuration)},r.fxDelay)};t.imageFx.init=function(){t.panelsBag.children("img").size==0&&t._errorReport("ImageFx #01",t.options.debug,1),t.options.fastchange=!1;var i=e.extend({},r,t.options.imagefx);if(i.strips<1||i.strips==undefined||isNaN(i.strips))i.strips=r.strips;if(i.fxDelay<0||i.fxDelay==undefined||isNaN(i.fxDelay))i.fxDelay=r.fxDelay;t.options.panelfxspeed=i.fxDelay*i.strips,t.options.auto&&t.options.autospeed<t.options.panelfxspeed&&(t.options.autospeed=t.options.panelfxspeed),t._wrapPanels(),t.panelsBag.css({background:'transparent url("'+e("img",t.currPanel).attr("src")+'") no-repeat 0 0',position:"relative",height:t.domObjHeight,width:t.domObjWidth}),e("."+n.textbox,t.domObj).css("z-index","4");if(e("."+n.strip,t.domObj).size()<1){var s="";for(j=1;j<i.strips+1;j++)s+='<div class="'+n.strip+'" style="float:left;position:absolute;z-index:3"></div>';t.panelsBag.append(s)}t.panelsBag.prepend('<a href="#" class="'+n.imageFxAnchor+'" style="position:absolute;top:0;left:0;display:none;z-index:6;width:100%;height:100%;"></a>')},t.imageFx.remove=function(){var r=e("."+n.strip,t.domObj);r.size()>0&&(r.remove(),t.panelsBag.css("background-image","none"),e("img",t.panels).show())},t._panelTransitions.fancy=function(s,a,f){t.animating=!0;var l=e("."+n.textbox,t.prevPanelStill);l.size()>0?l.animate({opacity:0},500,function(){o(),l.css({opacity:1})}):o();var c=e.extend({},r,t.options.imagefx);if(c.fxType!="random"&&i.indexOf(c.fxType)<0)t._errorReport("ImageFx #02",t.options.debug,0),c.fxType="curtain";else switch(c.fxType){case"random":c.fxType=i[Math.floor(Math.random()*i.length)];break;case"default":c.fxType=r.fxType}var h=e("."+n.imageFxAnchor,t.panelsBag),p=e("a:first-child",t.currPanel);p.attr("href")!=undefined?h.attr({href:p.attr("href"),title:p.attr("title"),target:p.attr("target")}).show():h.hide();var d=e("img",t.prevPanelStill).attr("src"),v=e("img",t.currPanel).attr("src");if(d==undefined||v==undefined)t._errorReport("ImageFx #03",t.options.debug,0);else{u(c,v,d,s);var m=setInterval(function(){e(":animated",t.panelsBag).size()==0&&(clearInterval(m),f(),!t.options.delaycaptions&&!t.options.fastchange&&setTimeout(function(){t.animating=!1},50))},100)}},t.options.panelfx=="fancy"&&t.imageFx.init()}})(jQuery);