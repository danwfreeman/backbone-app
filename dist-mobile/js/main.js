require(["jquery","underscore","backbone","scrollable","tms","sliderkit","sliderkitdelay","sliderkitcounter","sliderkittimer","sliderkitimagefx","mousewheel","customScrollbar","../common/models/cart/cart-item-collection","../common/models/user-info/user-info-model","../common/models/user-info/user-info-collection","../common/models/user-info/payment-info-model","../common/models/contact/contact-model","../common/models/user-info/credentials-model","../common/models/device-exchange/device-model","../common/models/device-exchange/device-collection","../common/views/contact/contact","../common/views/home/login","../common/views/device-exchange/device-list","../common/views/device-exchange/landing","../common/views/device-exchange/add","../common/views/device-exchange/search","../common/views/device-exchange/search-results","views/home/home","views/app/getapp","../common/views/home/privacy-policy","../common/views/home/privacy-policy-coppa","../common/views/home/terms-conditions","views/safety/safety","views/car/car","views/stickers/stickers","views/track/track","views/cart/cart","../common/views/cart/review-cart","../common/views/cart/payment","../common/views/cart/final-order","../common/views/cart/receipt","views/user/user-info","views/user/registration","../common/views/user/registration-success","../common/views/error-page","../common/utils","../common/catalog","../common/session","../common/zones"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J){var K=n.Router.extend({initialize:function(){this.appMode="main",this.utils=X,this.catalog=V,this.session=$,this.zones=J,this.messageArea=e(".message-area"),this.cartItemList=new h,this.userInfoList=new d,this.credentialsModel=new g,this.paymentInfo=null,this.deviceList=new b,this.paypalErrorList,n.Validation.configure({labelFormatter:"label"}),this.session.syncToServer(this.startRouterCallback,this.showError)},startRouterCallback:function(){n.history.start()},routes:{home:"showHome",stickers:"showStickers",track:"showTrack",checkout:"doCheckout",reg_checkout:"doRegisteredCheckout",shipping:"showShippingInfo",billing:"showShippingInfo",reviewCart:"showReviewCart","payment/:errors":"showPaymentInfo",payment:"showPaymentInfo",finalOrder:"showFinalOrder","receipt/:id/:code":"showReceipt","registration1/:email":"showRegistration1",registrationSuccess:"showRegistrationSuccess","registrationSuccess/:nav":"showRegistrationSuccessNav",login:"doCheckout",logout:"doLogout",getapp:"showGetApp",device:"showDevice",addDevice:"showAddDevice",searchDevices:"showDeviceSearchResults",searchDeviceResults:"showDeviceSearchResults",safety:"showSafety",blog:"showBlog",contactus:"showContactUs",cart:"showCart",car:"showCar",carPackage:"showCarPackage",contact:"showContact",policy:"showPolicy",policycoppa:"showCoppaPolicy",terms:"showTerms",error:"showErrorPage","*actions":"showHome"},showHome:function(){this.swapContentView(new k),this.setActiveTab("home"),e(".slider")._TMS({show:0,pauseOnHover:!0,prevBu:!1,nextBu:!1,playBu:!1,duration:1e3,preset:"fade",pagination:!0,pagNums:!1,slideshow:9e4,numStatus:!1,banners:"fromRight",waitBannerAnimation:!1,progressBar:!1})},showStickers:function(){this.swapContentView(new P),this.setActiveTab("stickers")},showTrack:function(){this.swapContentView(new H),this.setActiveTab("track")},showCar:function(e){var t=new D(e);this.swapContentView(t),this.setActiveTab("car")},showCarPackage:function(){this.showCar(!0),window.scrollTo(0,800)},doCheckout:function(e){this.credentialsModel.isAuthed()?this.doRegisteredCheckout():this.swapContentView(new E(e))},doRegisteredCheckout:function(){this.setActiveTab("cart");var e=this.userInfoList.where({type:this.userInfoList.model.SHIPPING})[0];e==null||e.get("id")==null||e.get("email")==null?this.showShippingInfo():this.showReviewCart()},showRegistrationSuccess:function(){this.swapContentView(new z)},showRegistrationSuccessNav:function(e){this.swapContentView(new z(e))},showCart:function(){var e=new B({collection:this.cartItemList});this.swapContentView(e),this.setActiveTab("cart"),this.cartItemList.updateTotals()},showShippingInfo:function(){this.setActiveTab("cart");var e=new R;this.swapContentView(e)},showReviewCart:function(){this.setActiveTab("cart"),this.swapContentView(new j)},showPaymentInfo:function(e){if(this.cartItemList.length===0){this.showMessage("You must have items in your cart to continue");return}this.setActiveTab("cart"),this.swapContentView(new F({model:new v},e))},showFinalOrder:function(){this.setActiveTab("cart"),this.swapContentView(new I)},showReceipt:function(e,t){this.setActiveTab("cart"),this.swapContentView(new q(e,t))},showGetApp:function(){this.setActiveTab("getapp"),this.swapContentView(new L)},showPolicy:function(){this.setActiveTab("home"),this.swapContentView(new A)},showCoppaPolicy:function(){this.setActiveTab("home"),this.swapContentView(new O)},showTerms:function(){this.setActiveTab("home"),this.swapContentView(new M)},showRegistration1:function(e){var t=new U(e);this.swapContentView(t)},showDevice:function(){this.setActiveTab("device"),this.swapContentView(new x)},showAddDevice:function(){this.swapContentView(new T({model:new y}))},showSearchDevices:function(){this.swapContentView(new N)},showDeviceSearchResults:function(){this.swapContentView(new C)},showSafety:function(){this.setActiveTab("safety"),this.swapContentView(new _)},showBlog:function(){app.navigate("home",!1),window.document.location.href="http://blog.appfxtoys.com"},showContactUs:function(){this.swapContentView(new w({model:new m})),this.setActiveTab("contactus")},showErrorPage:function(){this.setActiveTab("home"),this.swapContentView(new W)},setActiveTab:function(t){e("#navLinks a").removeClass("active"),e(".cartlink").removeClass("active"),t==="cart"?e(".cartlink").addClass("active"):e("#navLinks #"+t).addClass("active")},swapContentView:function(t){this.hideMessage(),this.currentView!=null&&this.currentView.remove(),this.currentView=t,e("#page-content").html(t.render()),typeof t["postRender"]=="function"&&t.postRender(),window.scrollTo(0,0)},showMessage:function(t){window.scrollTo(0,0),this.resetMessage(),this.messageArea.show(),e(".message",this.messageArea).html(t)},hideMessage:function(){this.messageArea.hide()},showError:function(t){this.showMessage(t),e(".message-area").addClass("error")},showWarning:function(t){this.showMessage(t),e(".message-area").addClass("warning")},resetMessage:function(){e(".message-area").removeClass("error"),e(".message-area").removeClass("warning")},showErrors:function(t){if(t==null||t.length==null)t=[],t.push("Sorry an unexpected error has occurred");window.scrollTo(0,0),this.messageArea.show();var n=e("<ul>");for(var r=0;r<t.length;r++)n.append(e("<li>"+t[r]+"</li>"));e(".message",this.messageArea).empty(),e(".message",this.messageArea).append(n),e(".message-area").addClass("error")},setLoginUserArea:function(t){var n=e("#header .user-name-area .user-name"),r=e("#header .user-name-area #logout"),i=e("#header .user-name-area #login");t===""?(n.hide(),r.hide(),i.show()):(n.show(),r.show(),i.hide()),e(".name",this.userNameArea).html(t)},doLogout:function(){this.session.removeServerSession(),this.cartItemList.updateHeaderTotal(),this.setLoginUserArea(""),this.showHome(new k)},loadTemplate:function(e,n){return t.template(e)}});window.app=new K});