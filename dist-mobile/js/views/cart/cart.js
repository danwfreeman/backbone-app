define(["jquery","underscore","backbone","views/cart/cart-item","text!templates/cart/cart.html"],function(e,t,n,r,i){var s=Backbone.View.extend({initialize:function(){this.template=t.template(i),t.bindAll(this,"clearSuccessCallback","clearErrorCallback")},render:function(e){this.$el.html(this.template());for(var t=0;t<this.collection.models.length;t++)this.renderCartItem(this.collection.models[t],t);return this.el},postRender:function(){this.$(".inner").ajaxStart(app.utils.showGlobalLoader).ajaxStop(app.utils.hideGlobalLoader)},updateTotals:function(){this.collection.updateTotals()},events:{"click #checkout":"checkout","click #clear-cart":"clearCart","click #continue":"continueShopping"},renderCartItem:function(e,t){var n=Math.round(e.get("quantity")*e.get("price")*100)/100;n=app.utils.padDecimal(n),e.set({total:n},{silent:!0});var i=new r({model:e});this.$("#cart-list").append(i.render().el)},checkout:function(e){e.preventDefault();var t=this.collection.models;if(t.length==null||t.length==0){app.showError("You must have at least one item in your cart to continue");return}var n=!0;for(var r=0;r<t.length;r++)t[r].validate(),t[r].isValid()===!1&&(n=!1);if(n===!1)return;app.navigate("checkout",!0)},clearCart:function(e){e.preventDefault(),this.collection.sync("delete",this.collections,{success:this.clearSuccessCallback,error:this.clearErrorCallback,wait:!0})},clearSuccessCallback:function(e,t,n){var r=this.collection;r.each(function(e){r.pop()}),this.render(),window.scrollTo(0,0),app.utils.hideGlobalLoader(),app.showMessage("Cart items were cleared")},clearErrorCallback:function(e,t,n){console.log("unable to clear cart items"),app.utils.hideGlobalLoader(),app.showMessage("Not able to clear your cart at this time")},continueShopping:function(e){app.navigate("home",!0)},getTitle:function(){return"Your Shopping Cart"}});return s});